# 仪表盘快速测试指南

## 🚀 快速开始

### 1. 启动开发服务器

```bash
npm run dev
```

服务将运行在 `http://localhost:3000`

### 2. 登录账户

访问 `http://localhost:3000/login`

**测试账户**（如果已注册）:
```
邮箱: test@example.com
密码: Test@2024Pass!
```

**或注册新账户**:
访问 `http://localhost:3000/signup`

### 3. 访问仪表盘

直接访问: `http://localhost:3000/dashboard`

或点击导航栏右上角用户头像 → "仪表板"

## 📋 测试检查清单

### ✅ 页面访问
- [ ] 未登录时自动跳转到登录页
- [ ] 登录后能正常访问仪表盘
- [ ] 页面加载时显示骨架屏
- [ ] 数据加载完成后显示完整内容

### ✅ 用户信息卡片
- [ ] 显示用户头像（首字母缩写）
- [ ] 显示用户名
- [ ] 显示邮箱地址
- [ ] 显示会员类型（FREE/PREMIUM/ENTERPRISE）
- [ ] 显示加入时间（格式化日期）

### ✅ 配额卡片 - Reddit 搜索
- [ ] 显示今日已使用次数
- [ ] 显示今日配额限制
- [ ] 进度条正确显示使用百分比
- [ ] 剩余次数正确计算
- [ ] 配额 <80%: 蓝色进度条
- [ ] 配额 80-99%: 黄色进度条
- [ ] 配额 ≥100%: 红色进度条 + 升级提示

### ✅ 配额卡片 - AI 对话
- [ ] 显示今日已使用次数
- [ ] 显示今日配额限制
- [ ] 进度条正确显示使用百分比（紫色）
- [ ] 达到限制时显示升级按钮

### ✅ 会员状态卡片
- [ ] 免费用户显示 "免费计划" 标识
- [ ] 显示权益列表（搜索/消息限额）
- [ ] 免费用户显示"升级会员"按钮
- [ ] 点击升级按钮跳转到 /pricing 页面

### ✅ 活动统计图表
- [ ] 显示总搜索次数（历史累计）
- [ ] 显示总消息数（历史累计）
- [ ] 进度条正确反映相对比例
- [ ] 显示配额重置时间提示

### ✅ 国际化
- [ ] 访问 `/dashboard` 显示英文
- [ ] 访问 `/zh/dashboard` 显示中文
- [ ] 日期格式本地化（中文/英文）
- [ ] 所有文案正确翻译

### ✅ 深色模式
- [ ] 切换到深色模式
- [ ] 所有卡片背景正确变化
- [ ] 文字颜色对比度合适
- [ ] 图标颜色正确适配
- [ ] 进度条在深色模式下清晰可见

### ✅ 响应式布局
- [ ] **桌面端** (>1024px): 左右分栏布局
- [ ] **平板端** (768-1024px): 响应式调整
- [ ] **移动端** (<768px): 单列堆叠布局
- [ ] 所有文字在小屏幕上可读

### ✅ 交互功能
- [ ] 点击"升级"按钮跳转到定价页
- [ ] 点击用户头像显示下拉菜单
- [ ] 导航栏链接正常工作
- [ ] 页面滚动流畅

## 🧪 功能测试场景

### 场景1: 新注册用户
1. 注册新账户
2. 访问仪表盘
3. **预期结果**:
   - ✅ Reddit 搜索: 0/3
   - ✅ AI 对话: 0/10
   - ✅ 总搜索: 0
   - ✅ 总消息: 0
   - ✅ 会员类型: 免费计划

### 场景2: 配额接近限制
1. 使用 2 次搜索功能
2. 刷新仪表盘
3. **预期结果**:
   - ✅ Reddit 搜索: 2/3 (66%)
   - ✅ 进度条显示黄色（接近限额）
   - ✅ 显示"剩余 1 次"

### 场景3: 配额达到限制
1. 使用完 3 次搜索
2. 刷新仪表盘
3. **预期结果**:
   - ✅ Reddit 搜索: 3/3 (100%)
   - ✅ 进度条显示红色
   - ✅ 显示"已达到今日限额"
   - ✅ 显示升级提示卡片
   - ✅ 升级按钮可点击

### 场景4: 语言切换
1. 访问 `/dashboard`（英文）
2. 切换语言到中文
3. 页面变为 `/zh/dashboard`
4. **预期结果**:
   - ✅ 所有文案显示中文
   - ✅ 日期格式: "2024年1月15日"
   - ✅ 按钮文字: "升级会员"

### 场景5: 深色模式切换
1. 点击导航栏月亮图标
2. 切换到深色模式
3. **预期结果**:
   - ✅ 背景变为深色
   - ✅ 卡片边框清晰可见
   - ✅ 文字对比度合适
   - ✅ 进度条颜色正确

## 🔍 API 测试

### 测试 Dashboard API

```bash
# 需要先登录获取 Cookie
curl -X GET http://localhost:3000/api/user/dashboard \
  -H "Cookie: next-auth.session-token=YOUR_TOKEN" \
  -H "Content-Type: application/json"
```

**预期响应**:
```json
{
  "quota": {
    "date": "2024-01-15T00:00:00.000Z",
    "searchesUsed": 2,
    "searchesLimit": 3,
    "messagesUsed": 5,
    "messagesLimit": 10
  },
  "stats": {
    "totalSearches": 45,
    "totalMessages": 128,
    "memberSince": "2024-01-01T10:30:00.000Z"
  },
  "user": {
    "name": "Test User",
    "email": "test@example.com",
    "membershipType": "FREE",
    "membershipExpiresAt": null
  }
}
```

### 测试未授权访问

```bash
curl -X GET http://localhost:3000/api/user/dashboard
```

**预期响应** (401):
```json
{
  "error": "Unauthorized"
}
```

## 🐛 常见问题

### Q1: 页面一直显示加载中
**排查步骤**:
1. 打开浏览器开发者工具（F12）
2. 查看 Network 标签
3. 检查 `/api/user/dashboard` 请求状态
4. 查看 Console 是否有错误

### Q2: 配额数据不正确
**解决方案**:
1. 检查数据库 `user_quotas` 表
2. 确认今日配额记录存在
3. 如不存在，API 会自动创建

```sql
-- 查询用户配额
SELECT * FROM user_quotas 
WHERE user_id = 'YOUR_USER_ID' 
ORDER BY date DESC 
LIMIT 5;
```

### Q3: 401 未授权错误
**解决方案**:
1. 确认已登录
2. 检查 Cookie 是否存在
3. 尝试重新登录

### Q4: 样式显示异常
**解决方案**:
1. 清除浏览器缓存（Cmd+Shift+R / Ctrl+Shift+R）
2. 检查 Tailwind CSS 是否正确加载
3. 查看浏览器控制台是否有 CSS 错误

## 📊 性能检查

### 页面加载性能
- [ ] 首次加载 < 2秒
- [ ] API 响应 < 500ms
- [ ] 骨架屏显示流畅
- [ ] 无明显的布局抖动 (CLS)

### 网络请求
- [ ] 仅发起 1 个 API 请求
- [ ] 无重复请求
- [ ] 请求携带正确的认证信息

## 📸 视觉回归测试

### 截图检查清单
- [ ] 桌面端浅色模式
- [ ] 桌面端深色模式
- [ ] 移动端浅色模式
- [ ] 移动端深色模式
- [ ] 英文版界面
- [ ] 中文版界面

## ✅ 完成标准

当所有以下条件满足时，测试通过：

1. ✅ 所有功能正常工作
2. ✅ 无 console 错误或警告
3. ✅ 响应式布局正确
4. ✅ 国际化完整
5. ✅ 深色模式正常
6. ✅ 性能指标达标
7. ✅ API 响应正确

## 🎯 下一步

测试通过后，可以继续完善：

1. **集成配额检查**
   - 在搜索和对话 API 中检查配额
   - 配额不足时返回 429 错误

2. **历史记录功能**
   - 搜索历史
   - 对话历史

3. **会员升级功能**
   - PayPal 支付集成
   - 会员状态自动更新

---

**祝测试顺利！** 🎉

如有问题，请查看 `docs/DASHBOARD_IMPLEMENTATION.md` 获取详细文档。
